@import url(../theme-base/theme-all.css);
/* Project overrides: ensure consistent layout for custom TOC page */
@import url(../../../overrides.css);

/**
 * Theme variables
 */
/* @font-face {
  font-family: '源暎ノンブル';
  src: local('源暎ノンブル'),
    url("../../../../../fonts/GenEiNombre.woff2") format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
} */

:root {
  --vs-theme--num-of-line: 15;
  --vs-theme--num-of-character: 39;
  --vs-theme--page-top-left-content: counter(page) '　' env(doc-title);
  --vs-theme--page-top-right-content: counter(page);
  --vs-theme--subsection-text-indent: 3rem;
  --vs-theme--anchor-color-body: darkblue;
}

:root {
  --vs-border-width: 0.5px;
  --vs-font-family: '游明朝', 'YuMincho', serif;
  --vs-font-size-on-print: 83.33%;
  --vs-line-height: 2;
  --vs-spacing-rlh: 0;
  --vs-writing-mode: vertical-rl;

  --vs--heading-font-weight: var(--vs-font-weight);
  --vs--h1-font-size: 1.35rem;
  /* --vs--h1-font-weight: var(--vs-font-weight-bold); */
  --vs--h1-letter-spacing: 0.125em;
  --vs--h1-line-height: 2.2rem;
  --vs--h1-margin-block: 0 1rem;
  --vs--h2-font-size: 1.18rem;
  --vs--h2-line-height: 2rem;
  --vs--h2-margin-block: 0 1rem;
  --vs--h3-font-size: 1rem;
  --vs--h3-font-family: '游ゴシック', 'YuGothic', sans-serif;
  --vs--h3-font-weight: var(--vs-font-weight-bold);
  --vs--h3-line-height: 2rem;
  --vs--h3-margin-block: 0 1rem;
  --vs--h4-font-size: 0.9375rem;
  --vs--h4-line-height: 2rem;
  --vs--h5-font-size: 0.875rem;
  --vs--h5-line-height: 2rem;
  --vs--h6-font-size: 0.75rem;
  --vs--h6-line-height: 2rem;
  --vs--rt-font-size: 0.6rem;
  /* 段落先頭約物の調整、行末句読点ぶら下げあり */
  --vs--p-hanging-punctuation: first allow-end;
  --vs--p-text-align: justify;
  --vs--p-text-indent: 1em;
  /* 約物の調整、和欧文間スペース */
  --vs--p-text-spacing: space-first allow-end ideograph-alpha ideograph-numeric;
  --vs--figcaption-margin-block: 1rem;

  /* Adding extra 1px to avoid unexpected page feeds */
  --vs-page--width: calc(1rem * var(--vs-line-height) * var(--vs-theme--num-of-line) + 1px);
  --vs-page--height: calc(1rem * var(--vs-theme--num-of-character));
  --vs-page--margin-top: auto;
  --vs-page--margin-bottom: auto;
  --vs-page--margin-inner: auto;
  --vs-page--margin-outer: auto;
  --vs-page--mbox-font-size: 8.5pt;

  --vs-footnote--font-size: 0.667rem;
  --vs-footnote--line-height: 1rem;
  --vs-footnote--area-before-margin-block: 0.25rem;
  --vs-footnote--area-before-margin-inline: 0 70%;
  /* Footnote call/marker style: use parentheses numbers （1）（2） */
  --vs-footnote--counter-style: decimal;
  --vs-footnote--call-content: '（'
    counter(vs-counter-footnote, var(--vs-footnote--counter-style)) '）';
  --vs-footnote--call-font-size: 0.7em;
  --vs-footnote--marker-content: '（'
    counter(vs-counter-footnote, var(--vs-footnote--counter-style)) '）' ' ';
}

:root:lang(ja) {
  --vs-crossref--counter-style: cjk-ideographic;
  --vs-crossref--call-fig-content: '図'
    target-counter(attr(href), fig, var(--vs-crossref--counter-style));
  --vs-crossref--call-tbl-content: '表'
    target-counter(attr(href), tbl, var(--vs-crossref--counter-style));
  --vs-crossref--marker-display: none;
  --vs-crossref--marker-fig-content: '図'
    counter(fig, var(--vs-crossref--counter-style)) '　';
  --vs-crossref--marker-tbl-content: '表'
    counter(tbl, var(--vs-crossref--counter-style)) '　';

  --vs-section--counter-style: cjk-ideographic;
  --vs-section--counter-delimiter: '・';
}

p {
  /* Keep Arabic numerals upright without affecting punctuation (e.g., em dash) */
  text-combine-upright: digits 2;
}

/* Notes section: make numbers upright (avoid leaning) */
h2#notoc-notes~p {
  text-orientation: upright;
  text-combine-upright: none;
}

h1 {
  padding-inline-start: 4.5em;
  text-indent: -4.5em;
}

/* h1: prevent extra gap between double em-dash by overriding tracking */
h1 .emdash-pair {
  letter-spacing: 0;
}

h2 {
  break-after: avoid;
  padding-inline-start: 6em;
  /* text-indent: -4em; */
  text-indent: -4em;
  margin-right: 1em;
}

h3 {
  text-indent: 1rem;
  font-size: 91%;
  margin-right: 1em;
  margin-left: 0;
}

/* Part title (中扉) page styling */
section:has(> h1#part1) {
  break-before: page;
  break-after: page;
  page: part-title;
}

h1#part1 {
  font-size: 1.6rem;
  letter-spacing: 0.15em;
  /* text-align: center; */
  margin-block: 4rem 0;
  padding-inline-start: 7.35rem;
  text-indent: -7.35rem;
}

@page part-title {
  /* Hide running headers/footers on the part title page */
  --vs-page--mbox-visibility: hidden;
}

/* 直前が h2 の場合は空白（マージン）をなくす */
h2+h3 {
  margin-right: 0;
}

h4,
h5,
h6 {
  text-indent: var(--vs-theme--subsection-text-indent);
}

/* Reset hanging indent for non-H2 headings to avoid layout break */

/* If a heading needs 5ch (e.g., 「第十一章　…」), add class .hang-5 */

/* h2.hang-5 {
  padding-inline-start: 5em;
  text-indent: -5em;
} */

figure {
  margin-block: unset;
  margin-inline: unset;
  writing-mode: horizontal-tb;
  max-width: var(--vs-page--width);
  max-height: var(--vs-page--height);
}

figure> :not(picture),
figure>picture>img {
  padding-inline: unset;
  padding-block: unset;
}

/* 縦中横 */
.tcy,
:not(.footnote)>a[href^='http']::after {
  text-combine-upright: all;
}

/* Make footnote calls upright without slant by combining only digits */
.footnote::footnote-call,
[role='doc-footnote']::footnote-call,
.footnote::footnote-marker,
[role='doc-footnote']::footnote-marker {
  text-combine-upright: digits 2;
  text-orientation: upright;
}

/* For noteref markup emitted as <a class="footnote-ref"><sup>…</sup></a> */
.footnote-ref>sup {
  text-combine-upright: digits 2;
  text-orientation: upright;
}

/* Ruby: keep Arabic numerals upright (avoid right-leaning) */
ruby rt {
  text-orientation: upright;
  text-combine-upright: digits 2;
}

.upright {
  text-orientation: upright;
}

/* 圏点（ゴマ） */
.sesame,
.sesame_dot {
  font-style: normal;
  text-emphasis-style: sesame;
}

.author {
  text-align: end;
  font-size: 1rem;
  font-weight: var(--vs-font-weight-bold);
  letter-spacing: 0.125em;
}

/* 奥付 */
[role='doc-colophon'] {
  font-size: 0.824rem;
  line-height: 1.5rem;
  margin-block-start: 6rem;
  break-inside: avoid;
}

.footnote,
:not(.footnote)>a[href^='http']::before {
  margin-inline-start: 2rem;
  text-indent: -1em;
}

/* Footnote text indentation: hang the marker */
.footnote,
[role='doc-footnote'] {
  margin-inline-start: 1.5em;
  text-indent: -1.5em;
}

.footnote::before,
[role='doc-footnote']::before {
  content: none;
}

@media screen {
  :root {
    --vs--anchor-color: var(--vs-theme--anchor-color-body);
    --vs--anchor-text-decoration: none;
    --vs--anchor-text-decoration-on-hover: underline;
  }

  body {
    max-inline-size: calc(1rem * var(--vs-theme--num-of-character));
    margin: 2rem;
  }

  figure {
    margin-inline: 1rem;
    max-inline-size: calc(var(--vs-page--width) - 4rem);
    block-size: min(var(--vs-page--height), calc(100vh - 6rem));
  }
}

@page {
  @top-left {
    margin-left: 7pt;
    margin-top: 8.5mm;
  }

  @top-right {
    margin-right: 7pt;
    margin-top: 8.5mm;
  }
}

@page :left {
  --vs-page--mbox-content-top-left: var(--vs-theme--page-top-left-content);
}

@page :right {
  --vs-page--mbox-content-top-right: var(--vs-theme--page-top-right-content);
}

/* ToC page numbers in per-digit Kanji (e.g., 一六一)
@counter-style kanji-digits {
  system: numeric;
  symbols: '〇' '一' '二' '三' '四' '五' '六' '七' '八' '九';
  fallback: cjk-ideographic;
} */

:root {
  /* Use Arabic numerals for ToC page numbers */
  --vs-toc--page-counter-style: decimal;
  /* Centered dotted leader using Katakana middle dot */
  --vs-toc--page-leader-content: leader('･') ' ';
}

/* Make ToC page numbers upright (not sideways) in vertical writing */
:is(#toc, [role='doc-toc']) li>a::after {
  text-orientation: upright;
  text-combine-upright: all;
  font-family: '源暎ノンブル', 'YuMincho', serif;
}

/* Allow long ToC items to break across pages to avoid large gaps */
:is(#toc, [role='doc-toc']) li {
  break-inside: auto;
}

/* Keep the entry line (title + leader + page number) together */
:is(#toc, [role='doc-toc']) li>a {
  break-after: auto;
  break-inside: avoid;
  display: block;
  padding-inline-start: 4em;
  text-indent: -4em;
}

/* ToC: make the Part I entry larger and remove page number/leaders */
:is(#toc, [role='doc-toc']) a[href$='#part1'] {
  font-size: 1.2em;
  /* font-weight: var(--vs-font-weight-bold); */
}

:is(#toc, [role='doc-toc']) a[href$='#part1']::after {
  content: none;
}

/* Fix layout for level-3 items in ToC */
:is(#toc, [role='doc-toc']) li[data-section-level='3']>a {
  padding-inline-start: 0;
  text-indent: 0;
}

/* Exclude specific headings from ToC by id prefix `notoc-` */
:is(#toc, [role='doc-toc']) li:has(> a[href*='#notoc-']) {
  display: none !important;
}

/* ToC: 5ch variant for anchors targeting specific chapter ids (#ch10-#ch19) */
:is(#toc, [role='doc-toc']) a[href$='#ch10'],
:is(#toc, [role='doc-toc']) a[href$='#ch11'],
:is(#toc, [role='doc-toc']) a[href$='#ch12'],
:is(#toc, [role='doc-toc']) a[href$='#ch13'],
:is(#toc, [role='doc-toc']) a[href$='#ch14'],
:is(#toc, [role='doc-toc']) a[href$='#ch15'],
:is(#toc, [role='doc-toc']) a[href$='#ch16'],
:is(#toc, [role='doc-toc']) a[href$='#ch17'],
:is(#toc, [role='doc-toc']) a[href$='#ch18'],
:is(#toc, [role='doc-toc']) a[href$='#ch19'] {
  padding-inline-start: 5em;
  text-indent: -5em;
}